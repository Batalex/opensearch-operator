# Copyright 2022 Canonical Ltd.
# See LICENSE file for licensing details.

set-tls-private-key:
  description: Set the private keys, which will be used for certificate signing requests (CSR). Run for each unit separately or on-leader only depending on the type.
  params:
    type:
      type: string
      enum:
        - app-admin
        - unit-transport
        - unit-http
      description: (Required) Type of private key to be set. "app-admin" must only be set on the leader.
    key:
      type: string
      description: (Optional) The content of the private key. The content will be auto-generated if not set.
    password:
      type: string
      description: (Optional) The passphrase of the private key. Will NOT be set if omitted.
  required:
    - category

put-client:
  description: Add new or update existing client
  params:
    name:
      type: string
      description: (Required) The name of the client, or in case "with-cert" set to true, it represents the CN (common name) of the certificate of the client.
    roles:
      type: string
      description: (Required) List of comma separated roles.
    password:
      type: string
      description: (Required) Password to be used on the HTTP requests (basic auth).
    hosts:
      type: string
      description: (Optional) The list of hosts the client is making requests from
    with-cert:
      type: boolean
      description: (Optional) Whether this client will authenticate using TLS.
      default: false
  required:
    - name
    - roles
    - password

delete-client:
  description: Delete client
  params:
    name:
      type: string
      description: (Required) Name of the client or its CN if it was created with-cert = true


# enum:
  # - app-admin
  #      - unit-transport
  #      - unit-http
